# Readme.md

This file (README.md) describes examples of:
- Estimatation an ODF from pole figures.  
- Creation of ODFs with specific orientation components and halfwidths.
- Output of the ODFs to a '.maa' format that can be read by the Rietveld analysis code MAUD
- Use of a colormap for ODFs and PFs that clearly deliniates between >1 multiples of a random distribution (mrd) or multiplies of a uniform distribution (mud) and <1 mrd/mud regions.  

While readable as a plain text, this file uses Markdown formatting.

This data was copied by the author from: https://github.com/usnistgov/Texture-Sampling-PhaseMeasurement-BiasErrors
Full citations are inlcluded in the 'How to Cite' section.  

Questions regarding this example may be directed to Adam Creuziger (adam.creuziger@nist.gov)

## Sections
- How to Cite
- NIST License
- NIST Disclaimers
- File and Directory Descriptions
- Programs Used
- File Format Descriptions
- Miscellaneous Comments

## Creation Date and Key Updates
Date | Description
--- | ---
2018 Apr 21 | Posted on GitHub
2020 May | Copied to MTex Examples

# How to Cite

## This example is created from the following data citation.  The example contents should be cited as:

A. Creuziger, C. Calhoun, W. Poling, T. Gnaupel-Herold, "Data Set: Assessment of Bias Errors Caused by Texture and Sampling Methods in Diffraction-Based Steel Phase Measurements", https://github.com/usnistgov/Texture-Sampling-PhaseMeasurement-BiasErrors

## This example is a companion to the following technical paper:

A. Creuziger, C. Calhoun, W. Poling, T. Gnaupel-Herold "Assessment of Bias Errors Caused by Texture and Sampling Methods in Diffraction-Based Steel Phase Measurements" (2018) Journal of Applied Crystallography, 51, p720-731. DOI: https://doi.org/10.1107/S160057671800420X

The technical paper describes the motivation and background for this example, as well as analysis and key insights that were made from this example.

## Citation Guidance

If you are utilizing the results or insights of this work, please cite the technical paper.  If you are utilizing parts of the programs or other documentation provided in the example, please cite the data set.

# NIST License

See LICENSE.TXT

This license is slightly different than the one described in the Mtex Examples home directory.  

# NIST Disclaimers

Certain commercial equipment, instruments, or materials are identified in this example in order to specify the experimental and computational procedure adequately. Such identification is not intended to imply recommendation or endorsement by the National Institute of Standards and Technology, nor is it intended to imply that the materials or equipment identified are necessarily the best available for the purpose.

# File and Directory Descriptions
- Pole figures for two transformation induced plasticity (TRIP) steels are provided in this example, labeled as "TRIP700" and "TRIP780" with corresponding directories in the "ExperimentalData" folder. Two phases are present in each material, and complete pole figures were measured for each phase. 
  -  The body centered cubic 'ferrite' phase is deliniated with a 'F' character appended to the measured (110), (200), and (211) hkl planes.  The material likely contains ferrite and martensite phases, but these were not resolvable and are combined in the data included here. 
  - The face centered cubic 'austenite' phase is deliniated with a 'A' character appended to the measured (200), (220) hkl planes for the TRIP 780 material and (111), (200), (220) and (311) hkl planes for the TRIP 700 material.
   - The original pole figures were rotated and orthotropic (orthrhombic) sample symmetry applied before saving as the .sum file.

- The Matlab script "ExperimentalPFs.m" analyzes and plots orientation distribution functions (ODFs) calculated by pole figure inversion.  The pole figure files are located in the "ExperimentalData/" directory. These pole figures are in a human readable .sum format exported from PF [7]. ODF figures generated by this script are saved in the "ExpFigures/" directory.

- The Matlab script "Calculated_textures.m" creates a series of ODFs with a range of common texture components and a range of texture sharpness.  ODFs in a .maa format readable by the texture analysis program MAUD were saved in the directory "MtexData/", while the phi2=45 (degrees) cross section for each ODF was plotted and saved in the "ODFFigures/" directory.

-  The Matlab scripts "ColorMap20.m", "ColorMap4.m", and "ColorMap8.m" were created to plot all ODFs and pole figures on the same color scale. This color map was created to clearly partition the ODF into values greater than 1 and less than 1, corresponding to the value of a uniform (random) texture distribution.  A grayscale map is used for multiples of a uniform (random) distribution less than 1 and color maps are used for multiples of a uniform (random) distribution equal to or greater than 1. This offers a clear demarcation between regions that have a higher texture volume fraction than uniform and regions that have a lower texture volume fraction than uniform. Using these colormaps require explicitly setting the colormap limits (clim) to match the range used.  For example, when using "ColorMap8.m", the range must be CLim(gcm,[0, 8]), where gcm is the current plot.  However, it seems that there are fewer levels plotted than exist in the data in mtex version 5.3.


- The Matlab script "CalculatedTexturesHWrange.m" is nearly identical to "CalculatedTexturesPlots.m".  The "CalculatedTexturesHWrange.m" script saves the plots for a wider range of halfwidths than "CalculatedTexturesPlots.m". Over 150 plots will be generated when running this script.

- The directories "ExpFigures/", "MtexData/", "ODFFigures/" have been added to the .gitignore file, and will be empty placeholders.

# Programs Used

#### The following application programs and versions were originally used in this example:
- Mac OS 10.11.6 and 10.12.5
- Matlab R2015a [1]
 - Mtex 4.3.2 [2]-- with fixes https://github.com/Mtex-toolbox/Mtex/issues/237
 
 #### We have tested the scripts on the following versions:
 - Mac OS 10.15.4
- Matlab R2019a [1]
 - Mtex 5.3.0 [2]-- with MacOS fixes described at https://mtex-toolbox.github.io/installation
 
The Matlab scripts assume that you have successfully installed the Matlab package Mtex.

### Citations for Programs:
- [1] MATLAB. Natick, MA: MathWorks Inc [Online]. Available: https://www.mathworks.com/product/Matlab.html
- [2] R. Hielscher and H. Schaeben, “A novel pole figure inversion method: specification of the Mtex algorithm,” Journal of Applied Crystallography, vol. 41, no. 6, pp. 1024–1037, Dec. 2008.
- [3] L. Lutterotti and P. Scardi, “Simultaneous structure and size–strain refinement by the Rietveld method,” Journal of Applied Crystallography, vol. 23, no. 4, pp. 246–252, 1990.
- [4] L. Lutterotti, “MAUD - Materials Analysis Using Diffraction.”  [Online]. Available: http://maud.radiographema.eu. [Accessed: 29-Apr-2017]
- [7] T. Gnäupel-Herold, PF. NIST NCNR [Online]. Available: https://www.ncnr.nist.gov/instruments/bt8/BT8DataAnalysis.htm

# File Format Descriptions

 File Extension	(Description) | how it was created
 --- | ---
.m	(Matlab Code)|  written using Matlab
.png	(Portable Network Graphics)| generated by Matlab
.maa	(BearTex ODF format?)| generated by Matlab.  No explicit format definition for this type of file could be found, so these files were reverse engineered from MAUD output. See notes below in miscellaneous comments.
.sum	(PF pole figure sum file)| generated by PF. This file contains a single line header, and then four columns of whitespace delimited data.

The programs and files should be platform independent. However, this claim has not been verified.  The dataset was created on Mac OS 10.11.6 and 10.12.5. As such the line endings likely use the line feed (LF) rather than combined carriage return and line feed (CR+LF).

# Miscellaneous Comments

- An internal naming method has been developed by the authors to track individual batches of materials (batch ID) in our research group. The batch IDs listed below uniquely identify a material that comes from the same coil/batch. These batch IDs may be referred to in subsequent publications to define if the material described is the same or a different material.
 - TRIP 780: B080401-AAC-001
 - TRIP 700: B050812-AAC-001

- Citations are non sequential to preserve continuity with the original readme file from https://github.com/usnistgov/Texture-Sampling-PhaseMeasurement-BiasErrors, while extra content has been removed to streamline this example.

- MAUD uses an .maa format for orientation distribution functions (ODFs), likely derived from BearTex [19]. No explicit documentation of these formats was found. However, upon inspection, this format is similar to the General Intensity File Format in PopLA [20, appendix B2], with a slightly different header and numeric type.  See the following for details:
  - [19] http://eps.berkeley.edu/~wenk/TexturePage/beartex.htm
  - [20] PopLA Manual http://pajarito.materials.cmu.edu/rollett/27750/popLA_Manual.pdf

- As Mtex can also output pole figures, the process of making ODFs in Mtex, exporting the ODFs from Mtex as a .maa file, importing the .maa file into MAUD, and then exporting pole figures in the .xpc format with MAUD may seem redundant and overly complex.  However, the ODFs generated in MAUD were not identical to those created in Mtex when pole figures from Mtex were imported into MAUD due to the different method for calculating ODFs used between the two programs. However, when the ODFs were used to generate the textures, the texture indexes matched to the resolution limit of the ODF export. The pole figures also had identical values to the resolution limit of the pole figure export. This was primarily evaluated by comparing the texture index values, as MAUD and Mtex cannot currently plot the ODFs on the same cross section.

- When importing the .maa files into MAUD, select the E-WIMV texture model and 5 degree ODF resolution.  The menu used for import contains a button to export PFs.

- We acknowledge the support of the National Institute of Standards and Technology, U.S. Department of Commerce, in providing the neutron research facilities used in this work.
